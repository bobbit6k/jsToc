class TableOfContents{constructor(e,t){this.containerId=e,this.startingHeading=t,this.validHeadings=["H1","H2","H3","H4","H5","H6"],this.encounteredIds=new Set}_generateId(e){let t=e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");t||(t="section");let i=t,n=1;for(;this.encounteredIds.has(i);)i=`${t}-${n}`,n++;return this.encounteredIds.add(i),i}generate(){let e=document.querySelector(this.containerId),t=document.querySelector("#toc");if(!e||!t)return;let i=this.validHeadings.indexOf(this.startingHeading.toUpperCase());if(-1===i)return;let n=Array.from(e.querySelectorAll(this.validHeadings.slice(i).join(", "))).map(e=>((!e.id||this.encounteredIds.has(e.id))&&(e.id=this._generateId(e.textContent)),this.encounteredIds.add(e.id),e));if(0===n.length)return;let d=document.createElement("ul");this._createList(n,d,i),t.appendChild(d)}_createList(e,t,i){e.forEach(e=>{let n=this.validHeadings.indexOf(e.tagName),d=document.createElement("li"),a=document.createElement("a");if(a.setAttribute("href",`#${e.id}`),a.textContent=e.textContent,d.appendChild(a),n===i)t.appendChild(d);else if(n>i){let r=document.createElement("ul");r.appendChild(d),t.lastChild.appendChild(r),t=r}else{let l=i-n,s=t.parentNode;for(let h=1;h<l;h++)s=s.parentNode;s.appendChild(d),t=s.lastChild}i=n})}}