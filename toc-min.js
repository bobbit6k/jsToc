class TableOfContents{constructor(e,t="H1",i="H6"){if(this.containerId=e,this.startingHeading=t.toUpperCase(),this.maxHeading=i.toUpperCase(),this.validHeadings=["H1","H2","H3","H4","H5","H6"],this.encounteredIds=new Set,!this.validHeadings.includes(this.startingHeading))throw Error(`Invalid starting heading: ${t}`);if(!this.validHeadings.includes(this.maxHeading))throw Error(`Invalid max heading: ${i}`);if(this.validHeadings.indexOf(this.startingHeading)>this.validHeadings.indexOf(this.maxHeading))throw Error("Starting heading cannot be larger than max heading")}_generateId(e){let t=e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");(!t||/^\d/.test(t))&&(t="section-"+t);let i=t,n=1;for(;this.encounteredIds.has(i);)i=`${t}-${n}`,n++;return this.encounteredIds.add(i),i}generate(){let e=document.querySelector(this.containerId),t=document.querySelector("#toc");if(!e||!t)throw Error("Required elements not found");let i=this.validHeadings.indexOf(this.startingHeading),n=this.validHeadings.indexOf(this.maxHeading),a=this.validHeadings.slice(i,n+1),d=Array.from(e.querySelectorAll(a.join(", "))).map(e=>(!e.id||this.encounteredIds.has(e.id)?e.id=this._generateId(e.textContent):this.encounteredIds.add(e.id),{element:e,level:this.validHeadings.indexOf(e.tagName)}));if(0===d.length){t.innerHTML="<p>No headings found</p>";return}let s=document.createElement("ul");s.className="toc-list";let l=s,r=i;d.forEach(({element:e,level:t})=>{let i=document.createElement("li"),n=document.createElement("a");if(n.href=`#${e.id}`,n.textContent=e.textContent,i.appendChild(n),t===r)l.appendChild(i);else if(t>r){let a=document.createElement("ul");a.appendChild(i),l.lastChild.appendChild(a),l=a}else{let d=r-t;for(;d>0&&l.parentElement?.parentElement;)l=l.parentElement.parentElement,d--;l.appendChild(i)}r=t}),t.innerHTML="",t.appendChild(s)}}