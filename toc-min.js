class TableOfContents{constructor(e,t,i="H6"){this.containerId=e,this.startingHeading=t,this.maxHeading=i,this.validHeadings=["H1","H2","H3","H4","H5","H6"],this.encounteredIds=new Set}_generateId(e){let t=e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");t||(t="section");let i=t,n=1;for(;this.encounteredIds.has(i);)i=`${t}-${n}`,n++;return this.encounteredIds.add(i),i}generate(){let e=document.querySelector(this.containerId),t=document.querySelector("#toc");if(!e||!t)return;let i=this.validHeadings.indexOf(this.startingHeading.toUpperCase());if(-1===i)return;let n=this.validHeadings.indexOf(this.startingHeading.toUpperCase()),a=this.validHeadings.indexOf(this.maxHeading.toUpperCase()),d=this.validHeadings.slice(n,a+1),s=Array.from(e.querySelectorAll(d.join(", "))).map(e=>((!e.id||this.encounteredIds.has(e.id))&&(e.id=this._generateId(e.textContent)),this.encounteredIds.add(e.id),e));if(0===s.length)return;let r=document.createElement("ul");this._createList(s,r,i),t.appendChild(r)}_createList(e,t,i){e.forEach(e=>{let n=this.validHeadings.indexOf(e.tagName),a=document.createElement("li"),d=document.createElement("a");if(d.setAttribute("href",`#${e.id}`),d.textContent=e.textContent,a.appendChild(d),n===i)t.appendChild(a);else if(n>i){let s=document.createElement("ul");s.appendChild(a),t.lastChild.appendChild(s),t=s}else{let r=i-n,l=t.parentNode;for(let h=1;h<r;h++)l=l.parentNode;l.appendChild(a),t=l.lastChild}i=n})}}